<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Tous Posts - Guy Evans</title><link>https://guy-evans.com/fr/posts/</link><description>Tous Posts | Guy Evans</description><generator>Hugo -- gohugo.io</generator><language>fr</language><lastBuildDate>Thu, 13 Jul 2023 14:32:51 +0000</lastBuildDate><atom:link href="https://guy-evans.com/fr/posts/" rel="self" type="application/rss+xml"/><item><title>Authentification des ports 802.1x avec des switches ARUBA</title><link>https://guy-evans.com/fr/posts/2023-07-11_802-1x-port-authentication-with-aruba-switches/</link><pubDate>Thu, 13 Jul 2023 14:32:51 +0000</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2023-07-11_802-1x-port-authentication-with-aruba-switches/</guid><description><![CDATA[<div class="featured-image">
                <img src="/thomas-jensen-ISG-rUel0Uw-unsplash.jpg" referrerpolicy="no-referrer">
            </div><h2 id="8021x---pourquoi-">802.1x - Pourquoi ?</h2>
<p>Dans les entreprises, nous utilisons souvent 802.1x pour s√©curiser l&rsquo;acc√®s aux r√©seaux c√¢bl√©s et sans fil. Pour les r√©seaux c√¢bl√©s, la norme 802.1x nous permet d&rsquo;exiger une authentification au niveau du port sur un switch compatible, ce qui nous permet √©galement d&rsquo;attribuer dynamiquement des VLAN au port et √† l&rsquo;appareil de connexion.</p>
<p>Imaginez une situation dans laquelle vous disposez d&rsquo;une salle de r√©union publique √©quip√©e de ports Ethernet accessibles et o√π vous souhaitez garantir un acc√®s s√©curis√© √† ces ports. Dans un tel sc√©nario, deux options s&rsquo;offrent √† vous :</p>
<ol>
<li>
<p>La premi√®re option consiste √† d√©sactiver tous les ports inutilis√©s. Bien que cette approche offre un certain niveau de s√©curit√©, elle pr√©sente un inconv√©nient. Que se passe-t-il si quelqu&rsquo;un a besoin d&rsquo;utiliser le port ? Dans ce cas, vous devrez vous connecter manuellement au switch, activer temporairement le port, puis le d√©sactiver √† nouveau une fois qu&rsquo;il n&rsquo;est plus utilis√©. Ce processus peut √™tre assez lourd et faire perdre du temps au personnel informatique.</p>
</li>
<li>
<p>La deuxi√®me option, plus efficace, consiste √† mettre en ≈ìuvre la norme 802.1X. Cette norme offre une solution sup√©rieure en maintenant les ports actifs √† tout moment. Avec la norme 802.1X, lorsqu&rsquo;un appareil de l&rsquo;entreprise est branch√© sur le port, il acc√®de automatiquement au r√©seau de l&rsquo;entreprise sur le VLAN attribu√©. En revanche, si un appareil inconnu est connect√©, il sera affect√© √† un VLAN de votre choix, g√©n√©ralement un r√©seau public avec acc√®s √† l&rsquo;internet uniquement. Cette s√©paration garantit que les appareils non autoris√©s ne peuvent pas acc√©der au r√©seau de l&rsquo;entreprise. L&rsquo;avantage est que vous n&rsquo;avez plus besoin d&rsquo;activer et de d√©sactiver manuellement les ports chaque fois qu&rsquo;un acc√®s est n√©cessaire.</p>
</li>
</ol>
<h2 id="de-quoi-avons-nous-besoin-">De quoi avons-nous besoin ?</h2>
<ul>
<li>Un serveur RADIUS (√† l&rsquo;IP 192.168.10.2) - nous utilisons Microsoft NPS (je ne d√©taillerai pas la configuration de NPS ici mais je le ferai peut-√™tre dans le futur).</li>
<li>Un switch g√©r√© - Il peut s&rsquo;agir de n&rsquo;importe quel switch g√©r√© capable de faire de l&rsquo;authentification de port, je fais cela sur un <a href="https://www.arubanetworks.com/products/switches/access/2930f-series/" target="_blank" rel="noopener noreffer ">ARUBA 2930F</a> (qui est un bon switch d&rsquo;ailleurs, si seulement je pouvais le ramener chez moi üòâ üòâ )</li>
<li>Quelques VLAN
<ul>
<li>VLAN d&rsquo;entreprise : 10</li>
<li>VLAN public : 20</li>
</ul>
</li>
<li>Un ordinateur Windows</li>
</ul>
<h2 id="commen√ßons-√†-configurer">Commen√ßons √† configurer</h2>
<h3 id="configuration-du-switch">Configuration du switch</h3>
<h4 id="configuration-des-vlan">Configuration des VLAN</h4>
<p>La premi√®re chose √† faire est d&rsquo;ajouter les vlans si ce n&rsquo;est pas d√©j√† fait. J&rsquo;ai tagg√© les vlans sur tous les ports pour des raisons de simplicit√©.</p>
<pre tabindex="0"><code>vlan 10 name VLAN10_Enterprise
vlan 10 tagged all
vlan 20 nom VLAN20_Publique
vlan 20 tagged all
vlan 30 name VLAN30_Telephonie
vlan 30 tagged all
</code></pre><h4 id="serveur-radius-et-authentification">Serveur Radius et authentification</h4>
<p>Ensuite, nous devons configurer le serveur RADIUS distant (notre serveur NPS) et indiquer au switch la &ldquo;secretkey&rdquo;</p>
<pre tabindex="0"><code>radius-server host 192.168.10.2 key &#34;secretkey&#34;
</code></pre><p>Ensuite, nous configurons EAP-RADIUS, ce qui permet au commutateur de transmettre les paquets d&rsquo;authentification des clients au serveur Radius.</p>
<pre tabindex="0"><code>aaa authentication port-access eap-radius
</code></pre><p>Nous activons ensuite 802.1x sur les ports de notre commutateur, ici nous le faisons sur une s√©rie de ports mais vous pouvez sp√©cifier des ports individuels, ou les s√©parer par une virgule. Nous demandons au switch de placer les clients autoris√©s sur le vlan 10 (auth-vid) et les clients non autoris√©s sur le vlan 20 (unauth-vid).</p>
<pre tabindex="0"><code>aaa aaa port-access authenticator 1-10
aaa aaa port-access authenticator 1-10 unauth-vid 20
aaa aaa port-access authenticator 1-10 auth-vid 10
aaa aaa port-access authenticator active
</code></pre><p>La configuration de notre switch est ainsi termin√©e. Ou bien est-ce le cas ?</p>
<h4 id="bonus-quen-est-il-des-t√©l√©phones-ip-">(Bonus) Qu&rsquo;en est-il des t√©l√©phones IP ?</h4>
<p>Vous avez peut-√™tre remarqu√© que j&rsquo;ai inclus un vlan pour les t√©l√©phones, car c&rsquo;√©tait une question importante que je me posais lors de mon premier d√©ploiement de 802.1x. Devrai-je ajouter chaque t√©l√©phone √† notre serveur Radius et configurer chaque t√©l√©phone pour l&rsquo;authentification ou utiliser MAB<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>?</p>
<p>Non ! Au lieu de cela, nous allons faire du vlan un vlan voice avec la commande suivante, ce qui permettra au t√©l√©phone d&rsquo;utiliser LLDP pour r√©cup√©rer le vlan qui lui a √©t√© assign√©, sans avoir besoin de l&rsquo;authentification.</p>
<pre tabindex="0"><code>vlan 30 voice
</code></pre><h4 id="conclusion">Conclusion</h4>
<p>La norme 802.1X c√¢bl√©e offre une authentification et un contr√¥le d&rsquo;acc√®s au niveau du port, garantissant que seuls les appareils autoris√©s peuvent se connecter au r√©seau. Elle permet l&rsquo;attribution dynamique de VLAN et √©limine la n√©cessit√© d&rsquo;une gestion manuelle des ports, ce qui renforce la s√©curit√© du r√©seau.</p>
<p>Dans cet article de blog, j&rsquo;ai voulu mettre en √©vidence la configuration c√¥t√© commutateur de 802.1X, en me concentrant sur le processus de configuration. Lorsqu&rsquo;un client non autoris√© est connect√© au port du switch, le syst√®me l&rsquo;affecte automatiquement au VLAN 10. De m√™me, lorsqu&rsquo;un t√©l√©phone est branch√©, il rejoint le VLAN 30 sans aucune configuration suppl√©mentaire. En ce qui concerne les clients autoris√©s, ils sont automatiquement plac√©s dans le VLAN 10.</p>
<p>En r√©sum√©, la norme 802.1X c√¢bl√©e offre une authentification et un contr√¥le d&rsquo;acc√®s au niveau du port, garantissant que seuls les appareils autoris√©s peuvent se connecter au r√©seau. Elle permet l&rsquo;attribution dynamique de VLAN et √©limine la n√©cessit√© d&rsquo;une gestion manuelle des ports, ce qui renforce la s√©curit√© du r√©seau.</p>
<hr>
<p><em>Photo par Thomas Jensen @ <a href="https://unsplash.com/fr/photos/ISG-rUel0Uw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreffer ">Unsplash.com</a></em></p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>MAC Authentication Bypass - <a href="https://networklessons.com/cisco/ccie-routing-switching-written/mac-authentication-bypass-mab" target="_blank" rel="noopener noreffer ">MAB - networklessons.com</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></description></item><item><title>D√©couverte de Caddy - un serveur web simple et rapide</title><link>https://guy-evans.com/fr/posts/2023-04-23_a-look-at-caddy-a-simple-and-fast-web-server/</link><pubDate>Sun, 23 Apr 2023 09:19:19 +0000</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2023-04-23_a-look-at-caddy-a-simple-and-fast-web-server/</guid><description><![CDATA[<div class="featured-image">
                <img src="/valery-sysoev-p9OkL4yW3C8-unsplash.webp" referrerpolicy="no-referrer">
            </div><p>Nous avons tous utilis√© Apache et NGNIX pour h√©berger un site web et ils sont tr√®s bien, mais pour √™tre honn√™te, je ne me suis jamais vraiment senti √† l&rsquo;aise avec leur configuration. Et c&rsquo;est ce qui m&rsquo;a amen√© √† <a href="caddyserver.com/" rel="">Caddy</a>. D√©couvrons ce que <a href="caddyserver.com/" rel="">Caddy</a> a √† offrir.</p>
<h1 id="caddy">Caddy</h1>
<p><a href="caddyserver.com/" rel="">Caddy</a> est un serveur web unique <em>(du moins je le pense)</em> avec un jeu de fonctionnalit√©s modernes. Vous pouvez l&rsquo;utiliser comme <a href="https://caddyserver.com/docs/proxy" target="_blank" rel="noopener noreffer ">reverse proxy et load balancer.</a> <a href="https://caddyserver.com/docs/fastcgi" target="_blank" rel="noopener noreffer ">h√©berger vos applications PHP avec lui.</a> Et m√™me <a href="https://caddyserver.com/docs/git" target="_blank" rel="noopener noreffer ">d√©ployer votre site</a> avec <code>git push</code>. Et j&rsquo;ai presque oubli√© l&rsquo;une des meilleures fonctionnalit√©s ; le HTTPS automatique, avec des certificats utilisant des fournisseurs comme <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreffer ">Lets Encrypt</a> et <a href="https://zerossl.com/" target="_blank" rel="noopener noreffer ">ZeroSSL</a>.</p>
<p>Cool, non ?</p>
<figure>
</figure>

<h2 id="installation">Installation</h2>
<p>Caddy est disponible sous la forme d&rsquo;un simple ex√©cutable, d&rsquo;une <a href="https://hub.docker.com/_/caddy" target="_blank" rel="noopener noreffer ">image docker</a> ou, comme d&rsquo;habitude, via un gestionnaire de paquets. Aujourd&rsquo;hui, nous utiliserons Debian. Mais si vous utilisez un autre syst√®me d&rsquo;exploitation, leur <a href="https://caddyserver.com/docs/install" target="_blank" rel="noopener noreffer ">documentation</a> devrait vous couvrir.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https
</span></span><span class="line"><span class="cl">curl -1sLf <span class="s1">&#39;https://dl.cloudsmith.io/public/caddy/stable/gpg.key&#39;</span> <span class="p">|</span> sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg
</span></span><span class="line"><span class="cl">curl -1sLf <span class="s1">&#39;https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt&#39;</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/caddy-stable.list
</span></span><span class="line"><span class="cl">sudo apt update
</span></span><span class="line"><span class="cl">sudo apt install caddy
</span></span></code></pre></div><p>Une fois install√©, le service s&rsquo;ex√©cutera automatiquement et servira la page de bienvenue par d√©faut sur le port 80. Caddy peut ensuite √™tre configur√© en utilisant le fichier <code>Caddyfile</code> dans <code>/etc/caddy</code></p>
<h2 id="configuration">Configuration</h2>
<p>Comme dit plus haut, caddy peut √™tre configur√© en utilisant le fichier <code>Caddyfile</code> √©crit en JSON dans <code>/etc/caddy</code>. Dans ce fichier, nous lui donnons des <a href="https://caddyserver.com/docs/caddyfile/directives" target="_blank" rel="noopener noreffer ">directives</a> pour qu&rsquo;il soit soit un reverse proxy, un serveur web, un front php, etc. Caddy peut aussi √™tre configur√© en utilisant son <a href="https://caddyserver.com/docs/api" target="_blank" rel="noopener noreffer ">API REST</a> si c&rsquo;est quelque chose qui vous int√©resse.</p>
<h3 id="reverse-proxy">Reverse Proxy</h3>
<p>Disons que vous avez une application qui fonctionne sur le port 9999 et que vous voulez faire un reverse proxy vers 443 (HTTPS). Le fichier de configuration ressemblerait √† ceci :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">demo.app.com</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="err">reverse_proxy</span> <span class="err">127.0.0.1:9999</span>
</span></span><span class="line"><span class="cl">    <span class="err">encode</span> <span class="err">gzip</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Pour que Caddy recharge le <code>Caddyfile</code>, il suffit de lancer un <code>systemctl reload caddy</code>, Caddy rechargera alors le fichier de configuration, demandera un certificat pour <code>demo.app.com</code> et servira votre application sur HTTPS<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<h3 id="fichiers-statiques">Fichiers statiques</h3>
<p>Ok un reverse proxy c&rsquo;est bien mais mon site web (celui-ci) est statique et g√©n√©r√© par <a href="gohugo.io" rel="">Hugo</a>, comment pourrions-nous le servir en utilisant caddy ? Encore une fois, 4 lignes de configuration suffisent.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">demo.website.com</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="err">#</span> <span class="err">o√π</span> <span class="err">sont</span> <span class="err">stock√©s</span> <span class="err">nos</span> <span class="err">fichiers</span> <span class="err">statiques</span>
</span></span><span class="line"><span class="cl">    <span class="err">root</span> <span class="err">*</span> <span class="err">/var/www/demo.droapp.com/public</span>
</span></span><span class="line"><span class="cl">    <span class="err">file_server</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Un rapide <code>systemctl reload caddy</code> plus tard et Caddy sert vos fichiers statiques sur HTTPS<sup id="fnref1:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> √† <code>demo.website.com</code>.</p>
<h3 id="php-fpm">PHP-fpm</h3>
<p>Vous utilisez habituellement Nginx comme fa√ßade/front pour PHP-fpm, mais Caddy peut aussi le faire. Et encore une fois avec un simple fichier de configuration.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">demo.website.com</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="err">#</span> <span class="err">o√π</span> <span class="err">sont</span> <span class="err">stock√©s</span> <span class="err">nos</span> <span class="err">fichiers</span>
</span></span><span class="line"><span class="cl">        <span class="err">root</span> <span class="err">*</span> <span class="err">/var/www/demo.website.com</span>
</span></span><span class="line"><span class="cl">        <span class="err">#</span> <span class="err">on</span> <span class="err">indique</span> <span class="err">√†</span> <span class="err">caddy</span> <span class="err">o√π</span> <span class="err">trouver</span> <span class="err">le</span> <span class="err">socket</span> <span class="err">php-fpm</span>
</span></span><span class="line"><span class="cl">	    <span class="err">php_fastcgi</span> <span class="err">/run/php/php8.2-fpm.sock</span>	
</span></span><span class="line"><span class="cl">        <span class="err">file_server</span>
</span></span><span class="line"><span class="cl">        <span class="err">encode</span> <span class="err">gzip</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Encore un rapide <code>systemctl reload caddy</code> et nous sommes maintenant en face d&rsquo;une application php sur HTTPS<sup id="fnref2:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<h2 id="bonus">Bonus</h2>
<h3 id="docker--docker-compose">Docker &amp; Docker Compose</h3>
<p>Caddy est aussi souvent ex√©cut√© avec Docker Compose et est toujours aussi simple. Voici un simple <code>docker-compose.yml</code> et nous pouvons utiliser n&rsquo;importe quel exemple de <code>Caddyfile</code> ci-dessus.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.7&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">caddy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">caddy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">unless-stopped</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;80:80&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;443:443&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;443:443/udp&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">$PWD/Caddyfile:/etc/caddy/Caddyfile</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">$PWD/caddy_data:/data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">$PWD/caddy_config:/config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">$PWD/site:/srv</span><span class="w"> </span><span class="c"># Si nous voulons servir des fichiers statiques dans $PWD/site</span><span class="w">
</span></span></span></code></pre></div><div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>Documentation<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Caddy poss√®de l&rsquo;une des meilleures <a href="https://caddyserver.com/docs/" target="_blank" rel="noopener noreffer ">documentation</a> que j&rsquo;aie vues depuis longtemps. Il existe de nombreuses autres fonctions que je n&rsquo;ai pas abord√©es ici.</div>
        </div>
    </div>
<p>Sur ce, je pense avoir couvert les bases de l&rsquo;utilisation de Caddy. L&rsquo;utilisez-vous ? Dites-moi comment et ce que vous en pensez.</p>
<figure>
</figure>

<p><em>Feature Photo originale de Valery Sysoev sur <a href="https://unsplash.com/@valerysysoev?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreffer ">Unsplash</a>.</em></p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Caddy ne r√©ussira √† demander un certificat que si les ports 80 et 443 sont ouverts sur votre serveur. Vous pouvez √©galement <a href="https://caddyserver.com/docs/automatic-https#activation" target="_blank" rel="noopener noreffer ">d√©sactiver la demande de certificat</a> si vous n&rsquo;en avez pas besoin. D&rsquo;autres <a href="https://caddyserver.com/docs/automatic-https" target="_blank" rel="noopener noreffer ">options</a> comme le HTTPS local peuvent √©galement √™tre utilis√©es.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref2:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></description></item><item><title>Sauvegardes avec Restic</title><link>https://guy-evans.com/fr/posts/2023-03-27_backups-with-restic/</link><pubDate>Tue, 28 Mar 2023 16:17:14 +0000</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2023-03-27_backups-with-restic/</guid><description><![CDATA[<div class="featured-image">
                <img src="/immo-wegmann-htsvneqf5fg-unsplash.jpg" referrerpolicy="no-referrer">
            </div><p>Apr√®s avoir eu la chance de ne perdre aucune de mes donn√©es sauvegard√©es sur mon nextcloud suite √† l&rsquo;incendie d&rsquo;OVH<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> üî• √† Strasbourg. J&rsquo;ai cependant perdu le VPS qui h√©bergeait le site web de <a href="https://www.evansmedia.fr" target="_blank" rel="noopener noreffer ">www.evansmedia.fr</a></p>
<blockquote>
<p>Les cordonniers sont toujours les plus mal chauss√©s, n&rsquo;est-ce pas ?</p>
<figure>
</figure>

</blockquote>
<p>Je suis peut-√™tre devenu un peu parano√Øaque en ce qui concerne les sauvegardes, en particulier pour tout ce qui est stock√© dans mon Nextcloud, qui contient √† peu pr√®s tout ce qui a trait √† ma vie personnelle, y compris les photos de notre nouveau-n√©.</p>
<h2 id="the-3-2-1-rule">The 3-2-1 Rule</h2>
<p>J&rsquo;ai d√©cid√© de b√¢tir ma strat√©gie de sauvegarde sur la r√®gle des 3-2-1 (et vous devriez en faire autant)</p>
<p>L&rsquo;id√©e qu&rsquo;une solution de sauvegarde minimale devrait comprendre trois copies des donn√©es, dont deux copies sur des supports diff√©rents et une copie distante (hors site).</p>
<figure>
 </figure>

<h3 id="sauvegardes-locales">Sauvegardes Locales</h3>
<p><em>(Nous simulons ici la sauvegarde d&rsquo;un serveur local, mais la machine virtuelle que je sauvegarde est en fait h√©berg√©e dans un centre de donn√©es, je la sauvegarde donc localement √† la maison)</em></p>
<p>Pour effectuer mes sauvegardes, j&rsquo;utilise deux outils, Proxmox Backup Server<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> qui est une application de sauvegarde construite par les cr√©ateurs de proxmox ; et Restic, une application moderne qui sauvegarde des fichiers vers des tas de services diff√©rents. Aujourd&rsquo;hui, nous allons nous concentrer sur un seul niveau de sauvegarde avec Restic.</p>
<h2 id="restic">Restic</h2>
<blockquote>
<p>restic est un logiciel de sauvegarde rapide, efficace et s√ªr. Il supporte les trois principaux syst√®mes d&rsquo;exploitation (Linux, macOS, Windows) et quelques autres plus petits (FreeBSD, OpenBSD).
<a href="https://restic.net/" target="_blank" rel="noopener noreffer ">https://restic.net/</a></p>
</blockquote>
<h3 id="pourquoi-restic">Pourquoi Restic</h3>
<ul>
<li>il est simple et rapide √† utiliser</li>
<li>il permet de sauvegarder de nombreux emplacements de stockage diff√©rents, y compris des services auto-h√©berg√©s et en ligne (Amazon S3, Google Drive, Backblaze, etc.)</li>
<li>ses sauvegardes peuvent √™tre enti√®rement <strong>chiffr√©es</strong></li>
<li>les restaurations sont simples et vous pouvez m√™me monter le d√©p√¥t de sauvegarde et r√©cup√©rer un seul fichier.</li>
</ul>
<h3 id="installer-restic">Installer Restic</h3>
<p>Tout d&rsquo;abord, nous devons installer Restic, c&rsquo;est aussi simple que d&rsquo;utiliser APT sur Ubuntu/Debian (dans mon cas d&rsquo;utilisation).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install restic
</span></span></code></pre></div><h3 id="initialiser-le-d√©p√¥t-de-stockage">Initialiser le d√©p√¥t de stockage</h3>
<p>La beaut√© de Restic est que vous pouvez utiliser √† peu pr√®s n&rsquo;importe quel type de stockage (local, Amazon S3, Minio Server, Backblaze B2, Azure, Google Cloud Storage, SFTP, etc.) pour votre repo (d√©pot) de sauvegarde et l&rsquo;interface reste en grande partie la m√™me. Dans ce cas, j&rsquo;utilise leur propre backend de stockage. <a href="https://github.com/restic/rest-server" target="_blank" rel="noopener noreffer "><strong>Rest-Server</strong></a></p>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>Rest-Server<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Rest Server est un serveur HTTP haute performance qui met en ≈ìuvre l&rsquo;API REST de restic. Il fournit un moyen s√ªr et efficace de sauvegarder des donn√©es √† distance, en utilisant le client de sauvegarde restic via l&rsquo;API rest : URL.</div>
        </div>
    </div>
<p>Maintenant que vous avez choisi le backend de stockage pour votre d√©p√¥t, nous devons l&rsquo;initialiser.</p>
<p>Disons que nous voulons nommer les sauvegardes de notre d√©p√¥t et nous pouvons utiliser la commande suivante pour l&rsquo;initialiser.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">restic -r rest:http://my-rest-server:8000/backups init
</span></span></code></pre></div><p>Restic vous demandera de cr√©er un mot de passe (gardez-le pr√©cieusement, nous en aurons besoin plus tard) et initialisera le d√©p√¥t. Nous pouvons utiliser <code>check</code> pour v√©rifier que le d√©p√¥t est initialis√©.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">restic -r rest:http://my-rest-server:8000/backups check
</span></span><span class="line"><span class="cl">enter password <span class="k">for</span> repository:
</span></span><span class="line"><span class="cl">password is correct
</span></span><span class="line"><span class="cl">create exclusive lock <span class="k">for</span> repository
</span></span><span class="line"><span class="cl">load indexesY
</span></span><span class="line"><span class="cl">check all packs
</span></span><span class="line"><span class="cl">check snapshots, trees and blobs
</span></span><span class="line"><span class="cl">no errors were found
</span></span></code></pre></div><h3 id="la-sauvegarde">La Sauvegarde</h3>
<p>Maintenant que nous avons un d√©p√¥t initialis√©, nous pouvons commencer √† sauvegarder nos photos de chats. Avec la commande <code>backup</code> et pointant vers le d√©p√¥t que nous avons cr√©√©. Ainsi, pour sauvegarder mon dossier <code>~/cat-pictures</code>, je lancerais la commande suivante</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">restic -r rest:http://my-rest-server:8000/backups backup ~/cat-pictures
</span></span></code></pre></div><p>Oui, c&rsquo;est aussi simple que √ßa üòé</p>
<p>A chaque fois qu&rsquo;une sauvegarde est lanc√©e, restic cr√©e un snapshot, vous pouvez les lister en utilisant la commande <code>snapshot</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">restic -r rest:http://my-rest-server:8000/snapshots
</span></span><span class="line"><span class="cl">enter password <span class="k">for</span> repository:
</span></span><span class="line"><span class="cl">password is correct
</span></span><span class="line"><span class="cl">ID        Date                 Host        Tags        Directory
</span></span><span class="line"><span class="cl">----------------------------------------------------------------------
</span></span><span class="line"><span class="cl">ac8721ec  2023-03-26 20:18:16  my-pc              /home/bounty/cat-pictures
</span></span><span class="line"><span class="cl">----------------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">1</span> snapshots
</span></span></code></pre></div><h3 id="restauration-des-photos-de-chats">Restauration des photos de chats</h3>
<p>Qu&rsquo;est-ce qu&rsquo;une sauvegarde si vous n&rsquo;avez pas test√© une restauration ? Ce n&rsquo;est pas une sauvegarde parce que vous ne savez pas si elle a fonctionn√©.</p>
<p>Essayons donc de restaurer nos images de chats avec la commande <code>restore</code>. Nous devons sp√©cifier l&rsquo;identifiant du snapshot <code>ac8721ec</code> et l&rsquo;endroit o√π nous voulons restaurer <code>~/restored-cat-pictures</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">restic -r rest:http://my-rest-server:8000/backups restore ac8721ec --target ~/restored-cat-pictures/
</span></span></code></pre></div><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>Astuces<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Vous pouvez utiliser <code>latest</code> √† la place de l&rsquo;identifiant du snapshot pour r√©f√©rencer le dernier snapshot.</div>
        </div>
    </div>
<p>C&rsquo;est aussi simple que la sauvegarde, non ?
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>Autres commandes et documentation<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Restic poss√®de de nombreuses autres commandes utiles que vous pouvez trouver dans leur excellente [documentation] (<a href="https://restic.readthedocs.io" target="_blank" rel="noopener noreffer ">https://restic.readthedocs.io</a>).</div>
        </div>
    </div></p>
<h3 id="automatisation-avec-un-script-bash-et-cron">Automatisation avec un script Bash et Cron</h3>
<p>Les sauvegardes manuelles sont bien mais vous risquez d&rsquo;oublier de les ex√©cuter, nous allons donc automatiser notre sauvegarde avec un script bash et une entr√©e cron. Et pour les points bonus, assurons-nous d&rsquo;avoir un moyen de nous envoyer un message en cas d&rsquo;√©chec. Mon script de base est ci-dessous, chaque action est expliqu√©e dans les commentaires.</p>
<p><em>Note : mon script est loin d&rsquo;√™tre parfait et peut contenir des erreurs, n&rsquo;h√©sitez pas √† le corriger ou √† sugg√©rer des am√©liorations ci-dessous</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">#This will run Restic backups</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Variables Restic</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">RESTIC_REPOSITORY</span><span class="o">=</span>rest:http://my-rest-server:8000/backups
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">RESTIC_PASSWORD</span><span class="o">=</span>super-secret-repo-password1234
</span></span><span class="line"><span class="cl"><span class="nv">RESTIC_Folder</span><span class="o">=</span><span class="s2">&#34;~/cat-pictures&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># On choisi ou on ecrit les logs</span>
</span></span><span class="line"><span class="cl"><span class="nv">Log_location</span><span class="o">=</span>/var/log/restic-nas.log
</span></span><span class="line"><span class="cl"><span class="c1"># Variables Telegram (si elles ne sont pas utilis√©es, vous devez supprimer le bloc entier pour telegram)</span>
</span></span><span class="line"><span class="cl"><span class="nv">TELEGRAM_token</span><span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="nv">TELEGRAM_chatid</span><span class="o">=</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Defini une fonction d&#39;horodatage</span>
</span></span><span class="line"><span class="cl">timestamp<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">date <span class="s2">&#34;+%b %d %Y %T %Z&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Inserer l&#39;horodatage et l&#39;en-t√™te dans le journal</span>
</span></span><span class="line"><span class="cl"><span class="nb">printf</span> <span class="s2">&#34;\n\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;-------------------------------------------------------------------------------&#34;</span> <span class="p">|</span> tee -a <span class="nv">$Log_location</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;</span><span class="k">$(</span>timestamp<span class="k">)</span><span class="s2">: restic.sh - Rest Backup started&#34;</span> <span class="p">|</span> tee -a <span class="nv">$Log_location</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Executer des sauvegardes</span>
</span></span><span class="line"><span class="cl"><span class="nv">NAS_backup_log</span><span class="o">=</span><span class="k">$(</span>restic backup <span class="nv">$RESTIC_Folder</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NAS_backup_log</span><span class="s2">&#34;</span> <span class="p">|</span> tee -a <span class="nv">$Log_location</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Il s&#39;agit d&#39;un moyen simple de v√©rifier que la sauvegarde a √©t√© un succ√®s et que les fichiers ont √©t√© ajout√©s √† la base de donn√©es, sinon nous √©chouons.</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$NAS_backup_log</span><span class="s2">&#34;</span> <span class="o">==</span> *<span class="s2">&#34;Added to the repo&#34;</span>** <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Si la sauvegarde a √©t√© r√©ussie, nous pouvons continuer et √©crire le r√©sultat dans le journal.</span>
</span></span><span class="line"><span class="cl">	<span class="nb">printf</span> <span class="s2">&#34;\n\n&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;-------------------------------------------------------------------------------&#34;</span> <span class="p">|</span> tee -a <span class="nv">$Log_location</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;</span><span class="k">$(</span>timestamp<span class="k">)</span><span class="s2">: restic.sh - COMPLETED - Rest Backup&#34;</span> <span class="p">|</span> tee -a <span class="nv">$Log_location</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Si la sauvegarde √©choue, nous √©crivons dans le journal et envoyons un message sur Telegram.</span>
</span></span><span class="line"><span class="cl">	<span class="nb">printf</span> <span class="s2">&#34;\n\n&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;-------------------------------------------------------------------------------&#34;</span> <span class="p">|</span> tee -a <span class="nv">$Log_location</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="k">$(</span>timestamp<span class="k">)</span><span class="s2">: restic.sh - FAILED - Rest Backup&#34;</span> <span class="p">|</span> tee -a <span class="nv">$Log_location</span>
</span></span><span class="line"><span class="cl"><span class="c1">## envoyer un message √† telegram</span>
</span></span><span class="line"><span class="cl">	curl -X POST https://api.telegram.org/<span class="nv">$TELEGRAM_token</span>/sendMessage <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	       	--data <span class="nv">parse_mode</span><span class="o">=</span>HTML --data <span class="nv">chat_id</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$TELEGRAM_chatid</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>		--data <span class="nv">text</span><span class="o">=</span><span class="s2">&#34;&lt;b&gt;</span><span class="k">$(</span>timestamp<span class="k">)</span><span class="s2">%0A FAILED - REST Backup&lt;/b&gt;%0A%0A&lt;pre&gt;</span><span class="nv">$NAS_backup_log</span><span class="s2">&lt;/pre&gt;&#34;</span> -4
</span></span><span class="line"><span class="cl">	<span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></div><p>Une fois que nous avons sauvegard√© notre script bash sous <code>~/restic_script.sh</code>, nous devons autoriser son ex√©cution avec <code>chmod</code> et l&rsquo;ajouter √† notre <a href="https://fr.wikipedia.org/wiki/Cron" target="_blank" rel="noopener noreffer ">crontab</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chmod +x ~/restic_script.sh <span class="c1"># permettre l&#39;ex√©cution de notre script</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">crontab -e <span class="c1"># √©diter notre crontab</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Edit this file to introduce tasks to be run by cron.</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>...<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To define the time you can provide concrete values for</span>
</span></span><span class="line"><span class="cl"><span class="c1"># minute (m), hour (h), day of month (dom), month (mon),</span>
</span></span><span class="line"><span class="cl"><span class="c1"># and day of week (dow) or use &#39;*&#39; in these fields (for &#39;any&#39;).</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>...<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># m h  dom mon dow   command</span>
</span></span><span class="line"><span class="cl"><span class="m">0</span> <span class="m">1</span> * * * ~/restic_script.sh <span class="c1"># ex√©cutera notre script tous les soirs √† 1 heure du matin</span>
</span></span></code></pre></div><p>Vous avez maintenant automatis√© vos sauvegardes.</p>
<p>Je suis s√ªr que vous avez une meilleure fa√ßon de proc√©der, pourquoi ne pas partager vos id√©es dans les commentaires ?</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><em>10 mars 2021</em> - Le site de l‚Äôentreprise OVH √† Strasbourg touch√© par un ¬´ important incendie ¬ª - <a href="https://www.lemonde.fr/societe/article/2021/03/10/" target="_blank" rel="noopener noreffer ">Le Monde</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://www.proxmox.com/en/proxmox-backup-server" target="_blank" rel="noopener noreffer ">Proxmox Backup Server</a> est une solution de sauvegarde qui permet de sauvegarder et de restaurer des VM, des conteneurs et des h√¥tes physiques.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></description></item><item><title>Mails auto-h√©berg√© - Pourquoi et comment?</title><link>https://guy-evans.com/fr/posts/2023-01-09_self-hosted-email-why-and-how/</link><pubDate>Sun, 15 Jan 2023 14:00:58 +0000</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2023-01-09_self-hosted-email-why-and-how/</guid><description><![CDATA[<div class="featured-image">
                <img src="/brett-jordan-lpzy4da9aro-unsplash.jpg" referrerpolicy="no-referrer">
            </div><h2 id="email">Email</h2>
<p>Question : Quel est le service sur Internet que nous utilisons r√©guli√®rement et qui fait partie de notre quotidien ? <strong>L&rsquo;EMAIL</strong></p>
<p>Il y a de fortes chances que si vous utilisez un ordinateur, vous ayez au moins une adresse e-mail, certains en ont plus d&rsquo;une (j&rsquo;ai perdu le compte). Cela m&rsquo;am√®ne √† une conviction profonde : si vous travaillez dans l&rsquo;informatique sous une forme ou une autre, votre adresse √©lectronique devrait √™tre la v√¥tre, avec votre propre nom de domaine <em>(<a href="mailto:hello@evans.fr" rel="">hello@evans.fr</a> par exemple)</em> au lieu d&rsquo;utiliser un @gmail.com @outlook.com ou @aol.com _(c&rsquo;est vieux √ßa) _ ou tout autre fournisseur.</p>
<h2 id="pourquoi-lauto-h√©bergement">Pourquoi (l&rsquo;auto-h√©bergement)</h2>
<p>Pour ma part, j&rsquo;avais l&rsquo;habitude d&rsquo;h√©berger toutes mes adresses e-mail sur Google Apps <em>(maintenant appel√© Google Workspace)</em>. Il √©tait simple de faire pointer les bons enregistrements mx vers leurs serveurs et voila votre propre messagerie.</p>
<p>De nombreux autres fournisseurs vous permettent √©galement de faire cela, mais l√† o√π Google a √©t√© intelligent, c&rsquo;est que leur service avait un excellent niveau gratuit (comme la bi√®re gratuite) jusqu&rsquo;√† ce qu&rsquo;ils d√©cident de supprimer le niveau gratuit. (Une autre raison pour laquelle les gens peuvent h√©berger eux-m√™mes leurs e-mails est d&rsquo;avoir un contr√¥le total sur le service et de ne pas partager de donn√©es avec les GAFAM).</p>
<p>Cela m&rsquo;a fait penser, pourquoi ne pas h√©berger mon propre email un jour. Donc, comme pour beaucoup de mes recherches, j&rsquo;ai commencer sur Reddit.com et le consensus g√©n√©ral est : Pourquoi s&rsquo;emb√™ter. Mais je continue quand m√™me mes recherches et d√©cide de continuer mon projet. Apr√®s tout, la meilleure fa√ßon d&rsquo;apprendre est de le faire. Comment cela peut-il √™tre aussi difficile ?</p>
<p><em>mais d&rsquo;abord, il nous faut du caf√©&hellip;</em>
<figure>
</figure>
</p>
<h2 id="comment-en-utilisant-docker-et-mailcow">Comment (en utilisant Docker et Mailcow)</h2>
<p>Je ne vais pas vous expliquer en d√©tail comment configurer un serveur de messagerie, car il existe de nombreux guides √† ce sujet, mais je vais au moins vous mettre sur la bonne voie.</p>
<h3 id="ce-dont-nous-avons-besoin">Ce dont nous avons besoin</h3>
<ol>
<li>Un nom de domaine de votre choix</li>
<li>Un serveur VM ou VPS avec : 2 VCPU, 4 Go de RAM (au minimum), 80 Go de stockage (ou plus), une adresse IP propre. <em>(Je sugg√®re <a href="https://milkywan.fr/" target="_blank" rel="noopener noreffer ">Milkywan</a> ou <a href="https://www.virtua.cloud/" target="_blank" rel="noopener noreffer ">Virtua.Cloud</a>, tous deux bas√©s en France et disposant d&rsquo;une excellente connectivit√©).</em></li>
<li>Docker &amp; Docker Compose (je sugg√®re d&rsquo;utiliser Docker car il est plus rapide √† mettre en place).</li>
<li><a href="https://mailcow.email/" target="_blank" rel="noopener noreffer ">Mailcow Dockerized</a>, mon serveur de messagerie pr√©f√©r√© - il contient tous les services n√©cessaires et fonctionne avec des conteneurs Docker.</li>
</ol>
<h3 id="configuration">Configuration</h3>
<h4 id="dns">DNS</h4>
<p>Pour que Mailcow fonctionne, vous devez configurer les enregistrements DNS suivants</p>
<pre tabindex="0"><code># Name              Type       Value
mail                IN A       1.2.3.4
autodiscover        IN CNAME   mail.example.org. (your ${MAILCOW_HOSTNAME})
autoconfig          IN CNAME   mail.example.org. (your ${MAILCOW_HOSTNAME})
@                   IN MX 10   mail.example.org. (your ${MAILCOW_HOSTNAME})
</code></pre><h4 id="installation-de-mailcow">Installation de Mailcow</h4>
<p>Une fois que les enregistrements DNS sont propag√©s, vous pouvez installer et configurer Mailcow.
Tout d&rsquo;abord, nous clonons le r√©f√©rentiel et d√©finissons les permissions sur les r√©pertoires.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">su
</span></span><span class="line"><span class="cl"><span class="nb">umask</span>
</span></span><span class="line"><span class="cl"><span class="m">0022</span> <span class="c1"># &lt;- V√©rifier que c&#39;est bien 0022</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /opt
</span></span><span class="line"><span class="cl">git clone https://github.com/mailcow/mailcow-dockerized
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> mailcow-dockerized
</span></span></code></pre></div><p>Une fois que vous aurez r√©pondu aux questions, le fichier de configuration sera g√©n√©r√© pour vous. Une fois g√©n√©r√©, nous pouvons lancer mailcow en utilisant les commandes suivantes</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker compose pull
</span></span><span class="line"><span class="cl">docker compose up -d
</span></span></code></pre></div><p>F√âLICITATIONS ! Vous avez install√© un serveur de messagerie (enfin presque).</p>
<p>Maintenant que le serveur fonctionne, vous pouvez acc√©der √† https://${MAILCOW_HOSTNAME} avec les informations d&rsquo;identification par d√©faut <code>admin</code> + le mot de passe <code>moohoo</code> et commencer √† configurer les domaines et les adresses e-mail.</p>
<p>Mailcow a un excellent <a href="https://docs.mailcow.email/post_installation/firststeps-ssl/" target="_blank" rel="noopener noreffer ">site d&rsquo;aide</a> qui vous guidera √† propos de la plupart des param√®tres que je n&rsquo;ai pas couverts.</p>
<h2 id="fin">Fin</h2>
<p>J&rsquo;esp√®re qu&rsquo;avec ce court article, vous pouvez voir qu&rsquo;il n&rsquo;est pas vraiment difficile de mettre en place un serveur de messagerie. Ce qui est difficile, c&rsquo;est de garder ses addrresses hors des listes de spam et de combattre le spam entrant, mais pour un usage personnel et avec l&rsquo;aide de Mailcow, vous devriez vous en sortir.</p>
<p>Une autre chose que vous ne devez pas oublier est &hellip; LES SAUVEGARDES.</p>
<p>Si vous h√©bergez votre courriel principal sur ce serveur, vous devriez le sauvegarder r√©guli√®rement.</p>
]]></description></item><item><title>D'un VPS √† un serveur en colocation, l'evolution de mon homelab - Partie 2</title><link>https://guy-evans.com/fr/posts/2022-12-24_vps-to-a-coloed-server-my-homelab-journey-part-2/</link><pubDate>Sat, 07 Jan 2023 16:04:28 +0000</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2022-12-24_vps-to-a-coloed-server-my-homelab-journey-part-2/</guid><description><![CDATA[<div class="featured-image">
                <img src="/cbo-rack-mw2.jpg" referrerpolicy="no-referrer">
            </div><h2 id="apr√®s-les-serveurs-virtuels">Apr√®s les serveurs virtuels</h2>
<p>Apr√®s avoir perdu l&rsquo;un de mes serveurs priv√©s virtuels ainsi que les donn√©es dans le <em>&lsquo;The Great Fire of OVH</em> üî•&rsquo;<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> (Oui je sais que j&rsquo;aurais d√ª avoir des sauvegardes de ce VPS<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>), je me suis dit pourquoi ne pas mettre en place un Cluster[^cluster] Proxmox<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> sur quelques serveurs d√©di√©s.</p>
<p>Apr√®s quelques recherches et j&rsquo;ai trouv√© <a href="https://oneprovider.com" target="_blank" rel="noopener noreffer ">OneProvider.com</a> o√π vous pouvez louer des serveurs d√©di√©s pour pas cher, leur mat√©riel bon march√© est vieux et la connectivit√© est correcte mais vous ne pouvez pas battre leurs prix (un serveur avec un Intel Atom C2750, 16 Go de RAM, 1 To de disque dur et 1 Go de bande passante &ldquo;illimit√©e&rdquo; co√ªtait 14 ‚Ç¨ par serveur/mois √† l&rsquo;√©poque). Cela s&rsquo;est bien pass√© pendant quelques mois, mais j&rsquo;√©tais de plus en plus frustr√© de ne pas avoir le contr√¥le total du mat√©riel et de mon int√©r√™t croissant pour BGP <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup> et la fa√ßon dont Internet n&rsquo;est en fait qu&rsquo;un ensemble de (petits) r√©seaux interconnect√©s. Apr√®s quelques essais et erreurs, j&rsquo;ai d√©cid√© que je devais revoir les objectifs de mon home-lab et repenser ma liste d&rsquo;achats.</p>
<figure>
</figure>

<h2 id="la-liste-des-achats">La liste des achats</h2>
<p>Alors, qu&rsquo;est-ce que je voulais ?</p>
<ul>
<li>Mon propre mat√©riel (r√©cent)</li>
<li>Un h√©bergeur convenable pour mon mat√©riel (fournisseur de colocation)</li>
<li>Une connexion de transit BGP avec mon propre bloc d&rsquo;adresses IP /24 lou√©es.</li>
</ul>
<p>Bonus :</p>
<ul>
<li>Une connexion de 10 Gb √† l&rsquo;internet</li>
</ul>
<p>J&rsquo;avais maintenant un plan et une liste d&rsquo;achats d√©cente, bien que nous n&rsquo;ayons pas parl√© du budget. Disons environ 700 ‚Ç¨ pour le mat√©riel et 100 √† 120 ‚Ç¨ par mois pour l&rsquo;h√©bergement.</p>
<h3 id="un-h√©bergeur">Un H√©bergeur</h3>
<p>J&rsquo;ai trouv√© un excellent h√©bergeur pour mon mat√©riel en parcourant <a href="https://lafibre.info/" target="_blank" rel="noopener noreffer ">LaFibre.info</a> un forum fran√ßais sur la FTTH en france et l&rsquo;informatique en g√©n√©ral. L&rsquo;h√©bergeur que j&rsquo;ai choisi est <a href="https://milkywan.fr" target="_blank" rel="noopener noreffer "><em>MilkyWan</em></a>, c&rsquo;est un petit fournisseur de services Internet √† but non lucratif g√©r√© par une petite √©quipe passionn√©e.</p>
<p>Ils sont sp√©cialis√©s dans la fourniture de serveurs virtuels, l&rsquo;h√©bergement, l&rsquo;ADSL et l&rsquo;Internet par fibre. Ils ont √©galement plusieurs points de pr√©sence dans des centres de donn√©es fran√ßais o√π ils peuvent h√©berger du mat√©riel et fournir du transit BGP. Ils ont √©galement une grande communaut√© sur telegram.</p>
<p>Co√ªt : 75 ‚Ç¨ pour un serveur 1U, une alimentation et une connexion r√©seau.</p>
<p>Bonus : Ils peuvent fournir une connexion 10Gb √† internet.</p>
<p><em>J&rsquo;ai mentionn√© qu&rsquo;ils ont une grande communaut√©, √©tant g√©r√© par une association √† but non lucratif et cela signifie qu&rsquo;ils ont √† c≈ìur les meilleurs int√©r√™ts de leurs membres et le reseau. Depuis la fin de 2022, je suis √©galement √©lu comme repr√©sentant des membres de l&rsquo;association.</em></p>
<h3 id="mon-propre-mat√©riel">Mon propre mat√©riel</h3>
<p>Maintenant que j&rsquo;avais trouv√© un endroit pour mon √©quipement, j&rsquo;avais besoin de cet √©quipement. J&rsquo;ai trouv√© ce dont j&rsquo;avais besoin sur <a href="https://www.bargainhardware.co.uk/" target="_blank" rel="noopener noreffer ">BargainHardware.co.uk</a>, ils sont sp√©cialis√©s dans le mat√©riel d&rsquo;entreprise d&rsquo;occasion et ont des prix tr√®s int√©ressants.</p>
<p>Voici le serveur que j&rsquo;ai choisi :</p>
<p><strong>Dell Poweredge R620</strong></p>
<ul>
<li>2 x Intel Xeon E5-2660 V2 2.20Ghz CPUs Dix c≈ìurs</li>
<li>96 Go de RAM DDR3</li>
<li>2 x 240 Go Crucial SSD pour les disques de d√©marrage (Ils seront en Raid 1 pour assurer la redondance en cas de d√©faillance d&rsquo;un disque)</li>
<li>6 disques durs SAS de 900 Go pour les disques de donn√©es, ce qui nous donne un total de 5 To d&rsquo;espace utilisable (il s&rsquo;agira du pool de stockage principal et il sera dans un pool ZFS pour assurer la redondance en cas de d√©faillance d&rsquo;un disque).</li>
<li>1 x carte r√©seau Dell BCM57800S Quad Port - 1GbE, 10GbE SFP+, RJ45</li>
</ul>
<p>Co√ªt : 700 ‚Ç¨, y compris les frais d&rsquo;exp√©dition vers la France.</p>
<p>Pas trop vieux pour √™tre peu rentable et pas trop r√©cent pour faire exploser la tirelire. Cela devrait me fournir beaucoup de puissance pour de multiples machines virtuelles.</p>
<h2 id="tout-mettre-en-place">Tout mettre en place</h2>
<p>Apr√®s avoir command√© le serveur et l&rsquo;h√©bergement, il ne me restait plus qu&rsquo;√† configurer <a href="https://www.proxmox.com" target="_blank" rel="noopener noreffer ">Proxmox</a> et √† envoyer mon tout nouveau serveur √† <em>Milkywan</em> qui me l&rsquo;a install√© dans son centre de donn√©es.</p>
<p>Je dispose maintenant de mon propre mat√©riel avec une connexion 10G dans un centre de donn√©es fran√ßais. Vous pouvez remarquer dans l&rsquo;image du speedtest ci-dessous que mon nom appara√Æt comme le FAI, c&rsquo;est parce que je suis effectivement devenu mon propre FAI puisque je fournis √† mon serveur l&rsquo;internet via mon propre ASN (<a href="https://bgp.he.net/AS211486" target="_blank" rel="noopener noreffer ">AS211486</a>) et mes IPs. (Cloudflare a un excellent article sur BGP <sup id="fnref1:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>)</p>
<p>Mon serveur h√©berge la plupart de mon &lsquo;homelab&rsquo;, y compris certaines parties de ce site web, comme le syst√®me de commentaires et les statistiques. J&rsquo;ai √©galement une petite installation √† la maison avec un NAS et un microserveur dont je vais probablement √©crire un autre billet √† ce sujet.</p>
<p><figure><a class="lightgallery" href="https://www.speedtest.net/result/c/bca2e66f-818f-413c-9ac0-01f538aaf561.png" title="10G Proof" data-thumbnail="https://www.speedtest.net/result/c/bca2e66f-818f-413c-9ac0-01f538aaf561.png" data-sub-html="<h2>Presque 10G mais c&#39;est une autre histoire</h2><p>10G Proof</p>">
        
    </a><figcaption class="image-caption">Presque 10G mais c'est une autre histoire</figcaption>
    </figure></p>
<p>Mon serveur est la derni√®re machine dans le rack sur l&rsquo;image d&rsquo;en-t√™te de ce post. Avez-vous voulu ou avez-vous mis en place votre propre homelab ? Partagez vos commentaires ci-dessous.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><em>10 mars 2021</em> - Le site de l‚Äôentreprise OVH √† Strasbourg touch√© par un ¬´ important incendie ¬ª - <a href="https://www.lemonde.fr/societe/article/2021/03/10/a-strasbourg-un-important-incendie-sur-le-site-de-l-entreprise-ovh-classe-seveso_6072548_3224.html" target="_blank" rel="noopener noreffer ">Le Monde</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Serveur priv√© virtuel&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><a href="https://www.proxmox.com" target="_blank" rel="noopener noreffer ">Proxmox Virtual Environment (PVE)</a> est une solution de virtualisation gratuite et open source qui permet le d√©ploiement de syst√®mes virtualis√©s&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Border Gateway Protocol (BGP) est le service postal d&rsquo;Internet. Lorsque quelqu&rsquo;un d√©pose une lettre dans une bo√Æte aux lettres, le service postal traite ce courrier et choisit un itin√©raire rapide et efficace pour livrer cette lettre √† son destinataire&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></description></item><item><title>Recommendations de Podcasts</title><link>https://guy-evans.com/fr/posts/2022-12-21_podcast-recommendations/</link><pubDate>Wed, 21 Dec 2022 17:20:57 +0000</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2022-12-21_podcast-recommendations/</guid><description><![CDATA[<div class="featured-image">
                <img src="/melanie-pongratz-becwwmiuj2k-unsplash.jpg" referrerpolicy="no-referrer">
            </div><div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>Note: Article uniquement en Anglais<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">D√©sol√©, mais comme j&rsquo;√©coute des podcasts uniquement en anglais, cet article ne sera qu&rsquo;en anglais.</div>
        </div>
    </div>
<p>I could be described as a passionate podcast listener, whether I&rsquo;m on public transport, wondering around town, doing some odd jobs around the flat or during a quiet period at work I usually stick on a podcast. Here are some of my recomendations</p>
<h2 id="it--cybersecurity">IT &amp; Cybersecurity</h2>
<h3 id="darknet-diaries---jack-rhysider">Darknet Diaries - Jack Rhysider</h3>
<figure>
</figure>

<p>Host Jack takes you on journeys about hackers,breaches, shadow government activity and cybercrime. Jack is a great story teller and his episodes are extremely well written and researched, sound design is also on point.</p>
<p><a href="https://darknetdiaries.com/" target="_blank" rel="noopener noreffer ">darknetdiaries.com</a></p>
<h3 id="risky-business---patrick-gray">Risky Business - Patrick Gray</h3>
<figure>
</figure>

<p>Risky Business is a weekly podcast that features mostly IT &amp; security news and great in-depth commentary from security industry experts. Hosted by journalist Patrick Grey it is always worth a listen.</p>
<p><a href="https://risky.biz/" target="_blank" rel="noopener noreffer ">risky.biz</a></p>
<h3 id="the-lazarus-hiest---geoff-white--jean-lee">The Lazarus Hiest - Geoff White &amp; Jean Lee</h3>
<figure>
</figure>

<p>Geoff White and Jean Lee take you on the story of &ldquo;Almost the Perfect Crime&rdquo;. Starts with a hacking ring and an attempt to steal a billion dollars. Investigators point to North Korea. Again another podcast that is well researched and written.</p>
<p><a href="https://www.bbc.co.uk/programmes/w13xtvg9/episodes/downloads" target="_blank" rel="noopener noreffer ">BBC World Service</a></p>
<!-- raw HTML omitted -->
<h2 id="crypto-scams">Crypto Scams</h2>
<h3 id="the-missing-cryptoqueen---jamie-bartlett">The Missing Cryptoqueen - Jamie Bartlett</h3>
<figure>
</figure>

<p>Jamie Bartlett and his team of researchers take you one the story of Dr Ruja Ignatova and the thrilling rise and fall of the biggest cryptocurrency ponzi schemes in history. Need I say more? Great story.</p>
<p><a href="https://www.bbc.co.uk/programmes/p07nkd84/episodes/downloads" target="_blank" rel="noopener noreffer ">BBC Radio 5 Live</a></p>
<h3 id="exit-scam---threats-media">Exit Scam - Threats Media</h3>
<figure>
</figure>

<p>Another Podcast about a crypto scam. Gerald Cotten, the founder of Canada&rsquo;s biggest Bitcoin exchange died under mysterious circumstances during a honeymoon trip to India in 2018.</p>
<p>His customers were told that the $215 million they&rsquo;d deposited on the exchange was lost forever ‚Äî because Gerry had forgotten to leave behind his passwords.</p>
<p>However quite a lot of people don&rsquo;t believe that he&rsquo;s dead.</p>
<p><a href="https://www.exitscam.show/" target="_blank" rel="noopener noreffer ">ExitScam.show</a></p>
<h2 id="crime">Crime</h2>
<h3 id="hunting-warhead---cbc-podcasts--vg">Hunting Warhead - CBC Podcasts &amp; VG</h3>
<figure>
</figure>

<p>A story of rescuing child abuse victims around the world, Hunting Wardhead follows the journalists and the police exposing the darkest corners of the internet. Great podcast although can be hard to listen to at times due to the subject matter.</p>
<p><a href="https://www.cbc.ca/listen/cbc-podcasts/387-hunting-warhead" target="_blank" rel="noopener noreffer ">CBC Podcasts</a></p>
<h3 id="death-in-ice-valley---bbc-world-service--nrk">Death in Ice Valley - BBC World Service &amp; NRK</h3>
<p><figure>
</figure>

Marit Higraff and Neil McCarth follows a two your investigation into the <a href="https://en.wikipedia.org/wiki/Isdal_Woman" target="_blank" rel="noopener noreffer ">Isdal Women</a> case, an unknown women whose burned body was found in western Norway in 1970.</p>
<p>Due to the interest in the podcast, new leads were gathered by crowd-source researchers, finally convinving the Bergen Police to reopen the case in 2016.
<!-- raw HTML omitted -->
<!-- raw HTML omitted --></p>
<hr>
<p>Thats all for now. Have you got a podcast suggestion? Drop it in the comments below</p>
<hr>
<p><em>Photo by Melanie Pongratz @ <a href="https://unsplash.com/s/photos/headphones-podcast?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreffer ">Unsplash.com</a></em></p>
]]></description></item><item><title>Config BGP IPv4 sur Mikrotik RouterOSv7</title><link>https://guy-evans.com/fr/posts/2022-11-13_bgp-ipv4-config-on-mikrotik-routerosv7/</link><pubDate>Sun, 13 Nov 2022 00:00:00 +0000</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2022-11-13_bgp-ipv4-config-on-mikrotik-routerosv7/</guid><description><![CDATA[<div class="featured-image">
                <img src="/screen-router.png" referrerpolicy="no-referrer">
            </div><p>Je connais quelques personnes qui font tourner leurs ASN sur des routeurs Mikrotik (sous RouterOS) car leur mat√©riel est bon march√© et facile √† trouver. Moi y compris, je fait du BGP sur leur image CHR pour annoncer mon propre ASN et mes pr√©fixes IP v4 et V6. RouterOS CHR est une image de RouterOS que vous pouvez ex√©cuter sur votre propre mat√©riel.</p>
<p>Avant on utilisait plus RouterOS version 6, mais maintenant la version 7 a quelques versions stables et est suppos√©e √™tre plus stable et plus rapide pour faire du BGP, j&rsquo;ai pens√© que je partagerais quelques configurations pour la version 7 car la syntaxe de la configuration a beaucoup chang√©. Aujourd&rsquo;hui je vais me concentrer sur IPv4 mais IPv6 est √† peu pr√®s le m√™me.</p>
<h3 id="attendez--asn-bgp-vous-mavez-perdu-">Attendez ! ASN, BGP, vous m&rsquo;avez perdu &hellip;</h3>
<h4 id="quest-ce-que-bgp-">Qu&rsquo;est-ce que BGP ?</h4>
<blockquote>
<p>Border Gateway Protocol (BGP) est le service postal d&rsquo;Internet. Lorsque quelqu&rsquo;un d√©pose une lettre dans une bo√Æte aux lettres, le service postal traite ce courrier et choisit un itin√©raire rapide et efficace pour livrer cette lettre √† son destinataire<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
</blockquote>
<h4 id="quest-ce-quun-syst√®me-autonome-et-les-asn-">Qu&rsquo;est-ce qu&rsquo;un syst√®me autonome et les ASN ?</h4>
<blockquote>
<p>L&rsquo;Internet est un r√©seau de r√©seaux*, et les syst√®mes autonomes sont les grands r√©seaux qui composent l&rsquo;Internet. Plus pr√©cis√©ment, un syst√®me autonome (AS) est un grand r√©seau ou groupe de r√©seaux qui poss√®de une politique de routage unifi√©e. Chaque ordinateur ou dispositif qui se connecte √† l&rsquo;Internet est connect√© √† un AS.</p>
</blockquote>
<blockquote>
<p>Chaque AS se voit attribuer un num√©ro officiel, ou num√©ro de syst√®me autonome (ASN), de la m√™me mani√®re que chaque entreprise poss√®de une licence commerciale avec un num√©ro unique et officiel. Mais contrairement aux entreprises, les parties externes font souvent r√©f√©rence aux AS par leur seul num√©ro.
<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></p>
</blockquote>
<p></p>
<h3 id="a-quoi-ressemble-la-configuration-">A quoi ressemble la configuration ?</h3>
<p>Voici les exports de configuration pour annoncer mes pr√©fixes via l&rsquo;AS 211486. Comme vous pouvez le voir, avant de faire quoi que ce soit, vous devez ajouter les pr√©fixes que vous voulez annoncer √† une liste de r√©seaux que vous sp√©cifierez dans le mod√®le bgp. Le reste devrait √™tre assez explicite mais j&rsquo;ai d√©taill√© les points principaux ci-dessous.</p>
<h4 id="mod√®lestemplates">Mod√®les/Templates</h4>
<p>ROSv7 a √©galement introduit le concept de mod√®les dans BGP, par exemple vous pouvez d√©finir un mod√®le pour iBGP, un pour les IXP et un autre pour eBGP. La je n&rsquo;utilise q&rsquo;un seul</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">/routing bgp template
</span></span><span class="line"><span class="cl">add <span class="nv">as</span><span class="o">=</span><span class="m">211486</span> <span class="nv">disabled</span><span class="o">=</span>no input.filter<span class="o">=</span>bgp-in <span class="nv">name</span><span class="o">=</span>as211486-public-out-ip4 output.filter-chain<span class="o">=</span>bgp-out .network<span class="o">=</span>bgp <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    routing-table<span class="o">=</span>main
</span></span><span class="line"><span class="cl">add address-families<span class="o">=</span>ipv6 <span class="nv">as</span><span class="o">=</span><span class="m">211486</span> <span class="nv">disabled</span><span class="o">=</span>no <span class="nv">name</span><span class="o">=</span>as211486-public-out-ip6 output.network<span class="o">=</span>bgp routing-table<span class="o">=</span>main
</span></span></code></pre></div><h4 id="filtres">Filtres</h4>
<p>Comme dans toute configuration BGP, nous avons des filtres. Mikrotik a modifi√© la syntaxe des filtres dans ROSv7, cela ressemble un peu √† bird. Leur <a href="https://help.mikrotik.com/docs/display/ROS/Route&#43;Selection&#43;and&#43;Filters#RouteSelectionandFilters-FilterSyntax" target="_blank" rel="noopener noreffer ">r√©f√©rence</a> est assez bonne.
Voici un ensemble de base de filtres entrants et sortants. Les deux premi√®res lignes autorisent toutes les routes r√©seau sous 0.0.0.0/0 mais pas 185.133.194.0/24 qui est le mien. La troisi√®me ligne permet √† mon pr√©fixe d&rsquo;√™tre annonc√© et rien d&rsquo;autre. Si aucun filtre n&rsquo;est d√©fini pour une route, elle sera rejet√©e.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">/routing filter rule
</span></span><span class="line"><span class="cl">add <span class="nv">chain</span><span class="o">=</span>bgp-in <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;STD IPv4 IN Filter&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no <span class="nv">rule</span><span class="o">=</span><span class="s2">&#34;if (dst in 0.0.0.0/0) {set bgp-local-pref 90 ; accept}&#34;</span>
</span></span><span class="line"><span class="cl">add <span class="nv">chain</span><span class="o">=</span>bgp-in <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;STD IPv4 IN Filter&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no <span class="nv">rule</span><span class="o">=</span><span class="s2">&#34;if (dst in 185.133.194.0/24) {reject}&#34;</span>
</span></span><span class="line"><span class="cl">add <span class="nv">chain</span><span class="o">=</span>bgp-out <span class="nv">comment</span><span class="o">=</span><span class="s2">&#34;STD IPv4 OUT Filter&#34;</span> <span class="nv">disabled</span><span class="o">=</span>no <span class="nv">rule</span><span class="o">=</span><span class="s2">&#34;if ( dst == 185.133.194.0/24 ) {accept}&#34;</span>
</span></span></code></pre></div><h4 id="connexion">Connexion</h4>
<p>Enfin, nous ajoutons la connexion qui r√©f√©rence le mod√®le, la liste de r√©seaux et les filtres que nous venons de cr√©er.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">/routing bgp connexion
</span></span><span class="line"><span class="cl">add <span class="nv">as</span><span class="o">=</span><span class="m">211486</span> <span class="nv">disabled</span><span class="o">=</span>no input.filter<span class="o">=</span>bgp-in local.role<span class="o">=</span>ebgp <span class="nv">name</span><span class="o">=</span>ip4-mw output.filter-chain<span class="o">=</span>bgp-out .network<span class="o">=</span>bgp <span class="sb">``</span>
</span></span><span class="line"><span class="cl">    remote.address<span class="o">=</span>80.67.167.166/32 router-id<span class="o">=</span>185.133.194.1 routing-table<span class="o">=</span>main <span class="nv">templates</span><span class="o">=</span>as211486-public-out-ip4
</span></span></code></pre></div><h4 id="route-blackhole">Route Blackhole</h4>
<p>Une chose que j&rsquo;oublie souvent est d&rsquo;ajouter une route blackhole √† ma table de routage pour les pr√©fixes que je voudrais annoncer. Sans cela, vous pouvez avoir les bons filtres mais rien ne sera annonc√© car le routeur n&rsquo;annoncera que les pr√©fixes qui se trouvent dans la table de routage.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">/ip route
</span></span><span class="line"><span class="cl">add blackhole <span class="nv">disabled</span><span class="o">=</span>no dst-address<span class="o">=</span>185.133.194.0/24
</span></span></code></pre></div><p>F√©licitations ! Vous annoncez maintenant un r√©seau avec BGP sur un RouterOSv7 de Mikrotik.</p>
<p></p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Source (Anglais): Qu&rsquo;est-ce que BGP ? | Le routage BGP expliqu√© - <a href="https://www.cloudflare.com/learning/security/glossary/what-is-bgp/" target="_blank" rel="noopener noreffer ">Cloudflare</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Source (Anglais): Qu&rsquo;est-ce qu&rsquo;un syst√®me autonome ? | Que sont les ASN ? - <a href="https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system/" target="_blank" rel="noopener noreffer ">Cloudflare</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></description></item><item><title>D'un VPS √† un serveur en colocation, l'evolution de mon homelab - Partie 1</title><link>https://guy-evans.com/fr/posts/2022-11-04_vps-to-a-coloed-server-my-homelab-journey/</link><pubDate>Fri, 04 Nov 2022 21:01:45 +0000</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2022-11-04_vps-to-a-coloed-server-my-homelab-journey/</guid><description><![CDATA[<div class="featured-image">
                <img src="/thomas-jensen-urtxbx5i5se-unsplash-2-.jpg" referrerpolicy="no-referrer">
            </div><p>J&rsquo;ai toujours eu un int√©r√™t pour les ordinateurs et la technologie. J&rsquo;√©tais loin de me douter qu&rsquo;il s&rsquo;agirait de la base de mon parcours professionnel.</p>
<p>C&rsquo;est pourquoi je souhaite retracer mes pas et expliquer comment je me suis retrouv√© avec un serveur situ√© dans un centre de donn√©es qui a fait de moi l&rsquo;administrateur syst√®me et r√©seau que je suis aujourd&rsquo;hui.</p>
<h2 id="comment-jai-commenc√©">Comment j&rsquo;ai commenc√©</h2>
<p>A 12 ans, j&rsquo;avais construit mon propre site web (mais c&rsquo;est une histoire pour un autre article).</p>
<p>√Ä 19 ans, j&rsquo;avais d√©j√† appris √† g√©rer des r√©seaux de petites entreprises et j&rsquo;en ai g√©r√© quelques-uns pour des entreprises familiales et des amis, mais je n&rsquo;avais pas d&rsquo;√©quipement ni rien pour apprendre et essayer des choses. C&rsquo;est alors que j&rsquo;ai appris ce qu&rsquo;√©tait un Homelab.</p>
<h3 id="quest-ce-quun-homelab-">Qu&rsquo;est-ce qu&rsquo;un Homelab ?</h3>
<p>Vous derriere, je vous entends &hellip; Qu&rsquo;est-ce qu&rsquo;un Homelab ?</p>
<blockquote>
<p>Un homelab, dans les termes les plus simples, est un environnement o√π vous pouvez apprendre et jouer avec des technologies nouvelles ou peu famili√®res.  Il peut s&rsquo;agir d&rsquo;un simple ensemble de machines virtuelles sur un vieux PC ou un ordinateur portable ou d&rsquo;un r√©seau complet complexe avec son propre ASN (nous y viendrons, √©ventuellement&hellip;).</p>
</blockquote>
<h3 id="serveurs-priv√©s-virtuels-avec-ovh">Serveurs priv√©s virtuels avec OVH</h3>
<h4 id="vps-num√©ro-1--le-site-web">VPS Num√©ro 1 : Le site web</h4>
<p>Apr√®s avoir fait quelques recherches, j&rsquo;ai conclu deux choses :</p>
<ol>
<li>Le service que je voulais h√©berger : mon site web.</li>
<li>L&rsquo;emplacement approximatif o√π je voulais qu&rsquo;il soit h√©berg√© : La France</li>
</ol>
<p>Apr√®s quelques recherches, j&rsquo;ai trouv√© <a href="https://ovh.fr" target="_blank" rel="noopener noreffer ">OVH</a>, un h√©bergeur bas√© en France. OVH proposait et propose toujours des serveurs priv√©s virtuels bon march√© et de tr√®s bonne qualit√©. J&rsquo;ai choisi un serveur 1vCore et 512 Mb RAM pour faire tourner mon site web bas√© sur Wordpress <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<p>Ce VPS <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> a fini par h√©berger le site web d&rsquo;EvansMedia, ma soci√©t√© de services informatiques et web jusqu&rsquo;au 10 mars 2021 et ce que je nomme <em>&lsquo;Le BBQ d&rsquo;OVH</em>&rsquo; üî• <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>, o√π leurs quatre datacenters de Strasbourg sont partis en fum√©e (litt√©ralement).</p>
<h4 id="vps-num√©ro-2--le-serveur-de-stockage">VPS num√©ro 2 : Le serveur de stockage</h4>
<p>Le prochain VPS <sup id="fnref1:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> est arriv√© lorsque je cherchais √† synchroniser mes fichiers sur mes nombreux appareils, pour des raisons de confidentialit√© je ne voulais pas utiliser Google Drive ou un √©quivalent. Je me suis retrouv√© sur Owncloud puis j&rsquo;ai migr√© vers Nextcloud qui est ce que j&rsquo;utilise encore aujourd&rsquo;hui. Nextcloud est fonctionnellement similaire √† Dropbox, Office 365 ou Google Drive, il peut √™tre h√©berg√© dans le cloud ou sur votre propre serveur.</p>
<p>La prochaine fois : Je reviendrai sur ce qui m&rsquo;a fait passer √† un serveur d√©di√© et peu apr√®s √† mon propre mat√©riel rack√© sans chez un operateur associatif.</p>
<hr>
<p><em>Photo par Thomas Jensen @ <a href="https://unsplash.com/@thomasjsn?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreffer ">Unsplash.com</a></em></p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://wordpress.org" target="_blank" rel="noopener noreffer ">Wordpress</a> est un syst√®me de gestion de contenu gratuit et open-source. En 2021, 30% des sites web du monde fonctionnaient avec Wordpress.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Serveur priv√© virtuel&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><em>10 mars 2021</em> - Le site de l‚Äôentreprise OVH √† Strasbourg touch√© par un ¬´ important incendie ¬ª - <a href="https://www.lemonde.fr/societe/article/2021/03/10/a-strasbourg-un-important-incendie-sur-le-site-de-l-entreprise-ovh-classe-seveso_6072548_3224.html" target="_blank" rel="noopener noreffer ">Le Monde</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></description></item><item><title>Hello World</title><link>https://guy-evans.com/fr/posts/2022-10-22_hello_world/</link><pubDate>Sun, 23 Oct 2022 13:00:35 +0200</pubDate><author>Guy Evans</author><guid>https://guy-evans.com/fr/posts/2022-10-22_hello_world/</guid><description><![CDATA[<div class="featured-image">
                <img src="/vladislav-klapin-PVr9Gsj93Pc-unsplash.jpg" referrerpolicy="no-referrer">
            </div><h2 id="hello-world-">Hello world !</h2>
<p>J&rsquo;ai longtemps song√© √† reconstruire un blog.</p>
<h3 id="quel-contenu-y-trouverez-vous-">Quel contenu y trouverez-vous ?</h3>
<ul>
<li>Projets sur lesquels je travaille</li>
<li>Pens√©es al√©atoires</li>
<li>Des trucs que j&rsquo;ai trouv√©s utiles</li>
<li>Des extraits de l&rsquo;infrastructure que j&rsquo;ai d√©ploy√©e</li>
<li>BEAUCOUP DE CHOSES AL√âATOIRES</li>
</ul>
<hr>
<p><em>Photo: Vladislav Klapin @ <a href="https://unsplash.com/photos/PVr9Gsj93Pc" target="_blank" rel="noopener noreffer ">unsplash.com</a></em></p>
]]></description></item></channel></rss>